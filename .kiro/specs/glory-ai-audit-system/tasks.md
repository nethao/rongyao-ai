# 任务列表 - 荣耀AI审核发布系统

## 阶段 1: 项目基础设施搭建

- [x] 1.1 初始化项目结构
  - [x] 1.1.1 创建前端项目（Vue 3 + Vite + Element Plus）
  - [x] 1.1.2 创建后端项目（FastAPI + Python 3.10+）
  - [x] 1.1.3 配置Docker Compose（PostgreSQL + Redis + LibreOffice）
  - [x] 1.1.4 配置开发环境依赖文件

- [x] 1.2 数据库初始化
  - [x] 1.2.1 创建数据库迁移脚本（Alembic）
  - [x] 1.2.2 实现所有数据表结构（users, submissions, drafts等）
  - [x] 1.2.3 创建初始管理员账号
  - [x] 1.2.4 编写数据库连接和会话管理代码

- [x] 1.3 基础配置系统
  - [x] 1.3.1 实现ConfigService配置管理服务
  - [x] 1.3.2 实现配置加密/解密功能
  - [x] 1.3.3 创建配置管理API端点
  - [x] 1.3.4 编写配置验证功能（LLM/OSS/IMAP）

## 阶段 2: 用户认证与授权

- [x] 2.1 实现认证服务
  - [x] 2.1.1 实现AuthService用户认证逻辑
  - [x] 2.1.2 实现JWT令牌生成和验证
  - [x] 2.1.3 实现密码哈希和验证
  - [x] 2.1.4 创建登录/登出API端点

- [x] 2.2 实现权限控制
  - [x] 2.2.1 实现基于角色的权限检查
  - [x] 2.2.2 创建权限装饰器/中间件
  - [x] 2.2.3 配置受保护的API端点
  - [x] 2.2.4 实现前端路由守卫

- [x] 2.3 前端登录界面
  - [x] 2.3.1 创建登录页面组件
  - [x] 2.3.2 实现登录表单验证
  - [x] 2.3.3 实现JWT令牌存储和管理
  - [x] 2.3.4 实现自动登出功能

## 阶段 3: 邮件抓取引擎

- [x] 3.1 IMAP邮件抓取
  - [x] 3.1.1 实现IMAP连接和认证
  - [x] 3.1.2 实现邮件列表获取和过滤
  - [x] 3.1.3 实现邮件内容解析
  - [x] 3.1.4 实现附件提取功能

- [x] 3.2 文档格式转换
  - [x] 3.2.1 实现LibreOffice headless调用
  - [x] 3.2.2 实现.doc到.docx转换
  - [x] 3.2.3 实现转换错误处理和重试
  - [x] 3.2.4 实现转换状态跟踪

- [x] 3.3 文档内容提取
  - [x] 3.3.1 实现.docx文本内容提取
  - [x] 3.3.2 实现.docx图片提取
  - [x] 3.3.3 实现图片元数据提取
  - [x] 3.3.4 实现内容结构化存储

- [x] 3.4 OSS图片上传
  - [x] 3.4.1 实现阿里云OSS客户端配置
  - [x] 3.4.2 实现图片上传功能
  - [x] 3.4.3 实现上传失败重试机制
  - [x] 3.4.4 实现图片URL记录和管理

- [x] 3.5 投稿记录创建
  - [x] 3.5.1 实现Submission数据模型
  - [x] 3.5.2 实现SubmissionService创建逻辑
  - [x] 3.5.3 实现图片关联记录
  - [x] 3.5.4 实现投稿状态管理

- [x] 3.6 定时任务调度
  - [x] 3.6.1 配置Celery任务队列
  - [x] 3.6.2 实现邮件抓取定时任务
  - [x] 3.6.3 配置任务调度策略（每5分钟）
  - [x] 3.6.4 实现任务状态监控

## 阶段 4: AI智能转换

- [x] 4.1 LLM集成
  - [x] 4.1.1 实现LLM API客户端
  - [x] 4.1.2 实现API密钥管理
  - [x] 4.1.3 实现请求重试和错误处理
  - [x] 4.1.4 实现响应解析

- [x] 4.2 转换提示词工程
  - [x] 4.2.1 设计第一人称到第三人称转换提示词
  - [x] 4.2.2 实现引用内容保护逻辑
  - [x] 4.2.3 实现时间表述规范化逻辑
  - [x] 4.2.4 实现人称替换逻辑（我局/我司 -> 来源）

- [x] 4.3 AI转换任务
  - [x] 4.3.1 实现AI转换Celery任务
  - [x] 4.3.2 实现转换结果验证
  - [x] 4.3.3 实现转换失败处理
  - [x] 4.3.4 实现转换进度跟踪

- [x] 4.4 草稿创建
  - [x] 4.4.1 实现Draft数据模型
  - [x] 4.4.2 实现DraftService创建逻辑
  - [x] 4.4.3 实现原文和转换内容关联
  - [x] 4.4.4 实现草稿状态管理

## 阶段 5: 审核分发后台

- [x] 5.1 投稿列表界面
  - [x] 5.1.1 创建投稿列表页面组件
  - [x] 5.1.2 实现投稿列表API调用
  - [x] 5.1.3 实现分页和筛选功能
  - [x] 5.1.4 实现状态标签显示

- [x] 5.2 双栏对比界面
  - [x] 5.2.1 创建审核页面组件
  - [x] 5.2.2 实现左右双栏布局
  - [x] 5.2.3 实现文本差异高亮算法
  - [x] 5.2.4 实现差异部分标记显示

- [x] 5.3 内容编辑功能
  - [x] 5.3.1 集成富文本编辑器
  - [x] 5.3.2 实现实时保存功能
  - [x] 5.3.3 实现保存状态提示
  - [x] 5.3.4 实现编辑锁定机制（防止并发编辑）

- [x] 5.4 版本管理功能
  - [x] 5.4.1 实现版本创建逻辑
  - [x] 5.4.2 实现版本历史查询API
  - [x] 5.4.3 创建版本历史界面组件
  - [x] 5.4.4 实现版本恢复功能

- [x] 5.5 恢复原文功能
  - [x] 5.5.1 实现恢复到AI版本API
  - [x] 5.5.2 添加恢复确认对话框
  - [x] 5.5.3 实现恢复后界面刷新
  - [x] 5.5.4 实现恢复操作日志记录

## 阶段 6: WordPress发布

- [x] 6.1 WordPress站点管理
  - [x] 6.1.1 实现WordPressSite数据模型
  - [x] 6.1.2 创建站点管理API端点
  - [x] 6.1.3 实现站点连接验证
  - [x] 6.1.4 创建站点管理界面（管理员）

- [x] 6.2 WordPress API集成
  - [x] 6.2.1 实现WordPress REST API客户端
  - [x] 6.2.2 实现文章创建功能
  - [x] 6.2.3 实现认证和授权
  - [x] 6.2.4 实现API错误处理

- [x] 6.3 发布服务实现
  - [x] 6.3.1 实现PublishService发布逻辑
  - [x] 6.3.2 实现图片URL替换
  - [x] 6.3.3 实现发布状态记录
  - [x] 6.3.4 实现发布失败回滚

- [x] 6.4 发布界面
  - [x] 6.4.1 创建站点选择对话框
  - [x] 6.4.2 实现发布按钮和确认流程
  - [x] 6.4.3 实现发布进度显示
  - [x] 6.4.4 实现发布结果提示

## 阶段 7: 数据清理与维护

- [x] 7.1 图片压缩任务
  - [x] 7.1.1 实现图片压缩算法
  - [x] 7.1.2 实现365天图片查询
  - [x] 7.1.3 实现OSS图片压缩调用
  - [x] 7.1.4 实现压缩状态记录

- [x] 7.2 数据删除任务
  - [x] 7.2.1 实现730天数据查询
  - [x] 7.2.2 实现级联删除逻辑
  - [x] 7.2.3 实现OSS文件删除
  - [x] 7.2.4 实现删除操作日志

- [x] 7.3 清理任务调度
  - [x] 7.3.1 实现清理Celery任务
  - [x] 7.3.2 配置每日凌晨2点执行
  - [x] 7.3.3 实现清理进度跟踪
  - [x] 7.3.4 实现清理结果通知

## 阶段 8: 系统监控与日志

- [x] 8.1 日志系统
  - [x] 8.1.1 配置结构化日志记录
  - [x] 8.1.2 实现TaskLog数据模型
  - [x] 8.1.3 实现关键操作日志记录
  - [x] 8.1.4 实现错误堆栈记录

- [x] 8.2 监控界面
  - [x] 8.2.1 创建系统监控页面（管理员）
  - [x] 8.2.2 实现任务队列状态显示
  - [x] 8.2.3 实现系统资源使用显示
  - [x] 8.2.4 实现日志查询界面

- [x] 8.3 实时通知
  - [x] 8.3.1 实现WebSocket服务器
  - [x] 8.3.2 实现任务状态推送
  - [x] 8.3.3 实现前端WebSocket客户端
  - [x] 8.3.4 实现通知消息显示

## 阶段 9: 测试

- [x] 9.1 单元测试
  - [x] 9.1.1 编写AuthService单元测试
  - [x] 9.1.2 编写SubmissionService单元测试
  - [x] 9.1.3 编写DraftService单元测试
  - [x] 9.1.4 编写PublishService单元测试
  - [x] 9.1.5 编写ConfigService单元测试

- [x] 9.2 基于属性的测试
  - [x] 9.2.1 编写文档处理属性测试（属性1-7）
  - [x] 9.2.2 编写AI转换属性测试（属性8-11）
  - [x] 9.2.3 编写审核界面属性测试（属性12-14）
  - [x] 9.2.4 编写版本管理属性测试（属性15-18）
  - [x] 9.2.5 编写WordPress发布属性测试（属性19-21）
  - [x] 9.2.6 编写配置管理属性测试（属性22-24）
  - [x] 9.2.7 编写认证授权属性测试（属性25-28）
  - [x] 9.2.8 编写数据清理属性测试（属性29-31）
  - [x] 9.2.9 编写异步任务属性测试（属性32-35）
  - [x] 9.2.10 编写日志监控属性测试（属性36-38）

- [x] 9.3 集成测试
  - [x] 9.3.1 编写邮件抓取到发布完整流程测试
  - [x] 9.3.2 编写异步任务执行测试
  - [x] 9.3.3 编写外部服务集成测试（使用mock）
  - [x] 9.3.4 编写并发用户测试

- [x] 9.4 性能测试
  - [x] 9.4.1 测试API响应时间
  - [x] 9.4.2 测试并发用户支持
  - [x] 9.4.3 测试大文件处理能力
  - [x] 9.4.4 测试系统资源使用

## 阶段 10: 部署与文档

- [x] 10.1 生产环境配置
  - [x] 10.1.1 配置生产环境Docker Compose
  - [x] 10.1.2 配置环境变量管理
  - [x] 10.1.3 配置HTTPS和域名
  - [x] 10.1.4 配置备份策略

- [x] 10.2 部署脚本
  - [x] 10.2.1 编写自动化部署脚本
  - [x] 10.2.2 编写数据库迁移脚本
  - [x] 10.2.3 编写健康检查脚本
  - [x] 10.2.4 编写回滚脚本

- [x] 10.3 用户文档
  - [x] 10.3.1 编写系统安装指南
  - [x] 10.3.2 编写用户操作手册
  - [x] 10.3.3 编写管理员配置指南
  - [x] 10.3.4 编写故障排查指南

- [x] 10.4 开发者文档
  - [x] 10.4.1 编写API文档
  - [x] 10.4.2 编写架构设计文档
  - [x] 10.4.3 编写代码贡献指南
  - [x] 10.4.4 编写测试指南
